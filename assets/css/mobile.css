/* ===== Mobile-first tokens ===== */
:root{
  --tap:48px; --gap:10px; --pad:14px;
  --ink:#111; --bg:#fff; --line:#e6e6e6;
}
@media (max-width:760px){
	
/* === Patch 2025-08-31 — Saisie sous la question === */
.row{
  grid-template-columns: 1fr !important;
  grid-template-areas:
    'lab'
    'inp'
    'res' !important;
}

  /* Conteneur + cartes plus respirants */
  .wrap{padding:12px !important}
  .card{padding:14px !important}

  /* Grilles → une colonne (tes .grid/.g2/.two etc.) */
  .grid, .g2, .grid.two, .grid2{display:grid;grid-template-columns:1fr !important;gap:var(--gap)}

  /* Champs sous la question + largeur 100% */
  .q input[type="text"], .q .answer, input[type="text"], textarea, select{
    width:100%; min-height:var(--tap); font-size:16px; /* évite le zoom iOS */
    margin-top:8px;
  }

  /* Boutons plus grands et cliquables */
  .controls button, .controls .btn, button, .kbd .key{
    min-height:var(--tap);
    padding:12px 14px; font-weight:600;
  }

  /* Tables scrollables si trop larges */
  table{display:block; overflow-x:auto; -webkit-overflow-scrolling:touch}
  table thead, table tbody{width:100%}

  /* Figures (SVG/canvas) fluides */
  svg, canvas, .figure, .circle-host{max-width:100% !important; width:100% !important; height:auto}

  /* Barre d’actions mobile en bas (duplique l’important) */
  .mb-actions{
    position:sticky; bottom:0; z-index:20;
    background:var(--bg); border-top:1px solid var(--line);
    padding:8px calc(10px + env(safe-area-inset-right)) calc(8px + env(safe-area-inset-bottom)) calc(10px + env(safe-area-inset-left));
    display:flex; gap:8px;
  }
  .mb-actions .btn{flex:1}

  /* Clavier math en tiroir */
  .kbd-host[data-collapsible]{position:fixed; left:0; right:0; bottom:0;
    background:#fff; border-top:1px solid var(--line);
    transform:translateY(100%); transition:transform .25s ease; z-index:30;
    padding-bottom:calc(env(safe-area-inset-bottom) + 6px);
  }
  .kbd-host[data-open="1"]{transform:translateY(0)}
  .kbd-toggle{position:fixed; right:12px; bottom:calc(64px + env(safe-area-inset-bottom));
    background:#111; color:#fff; border-radius:999px; padding:10px 14px; z-index:31}
}

/* Focus visibles partout */
:focus-visible{outline:2px solid #60a5fa; outline-offset:2px}


/* =========================================
   Fix MathJax SVG inline qui explose en géant sur mobile
   ========================================= */
@media (max-width:760px){

  /* 1. Toutes les formules inline doivent se comporter comme du texte normal */
  mjx-container[jax="SVG"][display="inline"]{
    display: inline-block;        /* reste dans la ligne */
    font-size: 1em !important;    /* taille texte */
    line-height: 1.2 !important;  /* n'ouvre pas la ligne à 4rem */
    vertical-align: -0.2em !important; /* descend un peu pour aligner visuellement */
    max-height: 1.2em;            /* empêche le container d'être géant */
    overflow: visible;
  }

  /* 2. Et on écrase la hauteur du SVG interne,
        parce que c'est lui qui impose la démesure */
  mjx-container[jax="SVG"][display="inline"] svg{
    height: 1em !important;       /* impose la vraie taille */
    width: auto;
  }

  /* 3. Dans les blocs de texte (énoncé, étapes, mini-tableaux…),
        pas d'espace en bas ajouté par nos styles desktop */
  .enonce mjx-container[jax="SVG"][display="inline"],
  .steps mjx-container[jax="SVG"][display="inline"],
  .uvtab mjx-container[jax="SVG"][display="inline"],
  .twocol-solution mjx-container[jax="SVG"][display="inline"]{
    padding-bottom: 0 !important;
    margin-bottom: 0 !important;
  }

  /* 4. Et on annule le padding-bottom prévu pour la version bureau */
  .steps mjx-container{
    padding-bottom: 0 !important;
  }
}

